{% extends "base.html" %}
{% block content %}

<style>
  body {
    background: linear-gradient(135deg, #1e293b, #0f172a, #1e293b);
    color: #f8fafc;
    font-family: 'Segoe UI', 'Tahoma', 'Arial', 'Cairo', sans-serif;
  }
</style>

<section class="py-5">
  <div class="container" style="max-width: 950px;">

    <!-- Heading -->
    <div class="text-center mb-4 p-4 rounded-4 shadow-lg"
         style="background: rgba(30, 41, 59, 0.8); backdrop-filter: blur(8px); color: #fff;">
      <h2 class="fw-bold mb-2" style="font-size: 2.2rem;">
        {% if lang == 'en' %}Share Your Story{% else %}Ø´Ø§Ø±Ùƒ Ù‚ØµØªÙƒ{% endif %}
      </h2>
      <p class="mb-2" style="font-size: 1.1rem; color: #cbd5e1;">
        {% if lang == 'en' %}
          Dear citizen, share your story to make your voice heard worldwide.
        {% else %}
          Ø¹Ø²ÙŠØ²ÙŠ Ø§Ù„Ù…ÙˆØ§Ø·Ù† ØŒ Ø´Ø§Ø±Ùƒ Ù‚ØµØªÙƒ Ù„Ù†ÙˆØµÙ„ ØµÙˆØªÙƒ Ù„Ù„Ø¹Ø§Ù„Ù…
        {% endif %}
      </p>
      <div class="alert alert-info border-0 fw-semibold mt-3"
           style="background: rgba(59,130,246,0.2); color: #bfdbfe;">
        {% if lang == 'en' %}
          ğŸ”’ Your name and identity will never appear. Donâ€™t worry, you are completely anonymous.
        {% else %}
          ğŸ”’ Ø§Ø³Ù…Ùƒ ÙˆÙ‡ÙˆÙŠØªÙƒ Ù„Ù† ØªØ¸Ù‡Ø± Ø£Ø¨Ø¯Ø§Ù‹. Ù„Ø§ ØªÙ‚Ù„Ù‚ØŒ Ù…Ø´Ø§Ø±ÙƒØªÙƒ Ù…Ø¬Ù‡ÙˆÙ„Ø© ØªÙ…Ø§Ù…Ø§Ù‹.
        {% endif %}
      </div>
    </div>

    <!-- Form Card -->
    <div class="card shadow-lg border-0 rounded-4"
         style="background: rgba(255,255,255,0.95); backdrop-filter: blur(8px);">
      <div class="card-body p-4">
        <form method="post" enctype="multipart/form-data" novalidate>

          <!-- Age group -->
          <div class="mb-3">
            <label class="form-label">Age</label>
            <select name="age" class="form-select" required>
              <option value="">Choose...</option>
              <option value="<20">&lt;20</option>
              <option value="20-24">20 - 24</option>
              <option value="25-29">25 - 29</option>
              <option value="30-34">30 - 34</option>
              <option value="35-39">35 - 39</option>
              <option value="40-44">40 - 44</option>
              <option value="45-49">45 - 49</option>
              <option value="50-54">50 - 54</option>
              <option value="55-59">55 - 59</option>
              <option value="60+">60+</option>
            </select>
          </div>

          <!-- Gender -->
          <div class="mb-3">
            <label class="form-label fw-semibold">{% if lang == 'en' %}Gender{% else %}Ø§Ù„Ø¬Ù†Ø³{% endif %}</label>
            <select name="gender" class="form-select" required>
              <option value="">{% if lang == 'en' %}Select{% else %}Ø§Ø®ØªØ±{% endif %}</option>
              <option value="Male">{% if lang == 'en' %}Male{% else %}Ø°ÙƒØ±{% endif %}</option>
              <option value="Female">{% if lang == 'en' %}Female{% else %}Ø£Ù†Ø«Ù‰{% endif %}</option>
              <option value="Prefer not to say">{% if lang == 'en' %}Prefer not to say{% else %}Ø£ÙØ¶Ù„ Ø¹Ø¯Ù… Ø§Ù„Ù‚ÙˆÙ„{% endif %}</option>
            </select>
          </div>

          <!-- Region -->
          <div class="mb-3">
            <label for="region" class="form-label fw-semibold">{% if lang == 'en' %}Location / State{% else %} Ù…ÙƒØ§Ù† Ø­Ø¯ÙˆØ« Ø§Ù„Ù‚ØµØ© - Ø§Ù„ÙˆÙ„Ø§ÙŠØ©{% endif %}</label>
            <select id="region" name="state" class="form-select" required>
              <option value="">{% if lang == 'en' %}Select Region{% else %}Ø§Ø®ØªØ± Ø§Ù„Ù…Ù†Ø·Ù‚Ø©{% endif %}</option>
              <option value="Khartoum">Khartoum State</option>
              <option value="Gezira">Gezira</option>
              <option value="Kassala">Kassala</option>
              <option value="Red Sea">Red Sea</option>
              <option value="Blue Nile">Blue Nile</option>
              <option value="White Nile">White Nile</option>
              <option value="North Kordofan">North Kordofan</option>
              <option value="South Kordofan">South Kordofan</option>
              <option value="East Darfur">East Darfur</option>
              <option value="West Darfur">West Darfur</option>
              <option value="North Darfur">North Darfur</option>
              <option value="South Darfur">South Darfur</option>
              <option value="Central Darfur">Central Darfur</option>
              <option value="Northern State">Northern State</option>
              <option value="River Nile">River Nile</option>
              <option value="Sennar">Sennar</option>
            </select>
          </div>

          <!-- Localities -->
          <div class="mb-3 d-none" id="locality-wrapper">
            <label for="locality" class="form-label fw-semibold">{% if lang == 'en' %}Locality{% else %}Ø§Ù„Ù…Ø­Ù„ÙŠØ©{% endif %}</label>
            <select id="locality" name="locality" class="form-select"></select>
          </div>

          <!-- Time that Story Took Place -->
          <div class="mb-3">
            <label class="form-label fw-semibold">{% if lang == 'en' %}Time that the Story Took Place- If you still remember{% else %}Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ø°ÙŠ Ø­Ø¯Ø«Øª ÙÙŠÙ‡ Ø§Ù„Ù‚ØµØ© - Ø§Ø°Ø§ Ù…Ø§ Ø²Ù„Øª ØªØ°ÙƒØ±Ù‡{% endif %}</label>
            <select name="time" class="form-select" required>
              <option value="">{% if lang == 'en' %}Select Time{% else %}Ø§Ø®ØªØ± Ø§Ù„ÙˆÙ‚Øª{% endif %}</option>
              <option value="April â€“ June 2023">April â€“ June 2023 (beginning of the war)</option>
              <option value="July â€“ September 2023">July â€“ September 2023</option>
              <option value="October â€“ December 2023">October â€“ December 2023</option>
              <option value="January â€“ March 2024">January â€“ March 2024</option>
              <option value="April â€“ June 2024">April â€“ June 2024</option>
              <option value="July â€“ September 2024">July â€“ September 2024</option>
              <option value="October â€“ December 2024">October â€“ December 2024</option>
              <option value="January â€“ March 2025">January â€“ March 2025</option>
              <option value="April â€“ June 2025">April â€“ June 2025</option>
              <option value="July 2025 â€“ Present">July 2025 â€“ Present</option>
            </select>
          </div>

          <!-- Type of Misinformation -->
          <div class="mb-3">
            <label for="misinfo" class="form-label fw-semibold">{% if lang == 'en' %}Type of Misinformation{% else %}Ù†ÙˆØ¹ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø© Ø§Ù„Ù…Ø¶Ù„Ù„Ø©{% endif %}</label>
            <select id="misinfo" name="misinfo" class="form-select" required>
              <option value="">{% if lang == 'en' %}Select Type{% else %}Ø§Ø®ØªØ± Ø§Ù„Ù†ÙˆØ¹{% endif %}</option>
              <option value="Ø·Ø±Ù‚ ØºÙŠØ± Ø§Ù…Ù†Ø©">Ø·Ø±Ù‚ ØºÙŠØ± Ø§Ù…Ù†Ø©</option>
              <option value="Ù…Ø³ØªØ´ÙÙŠØ§Øª">Ù…Ø³ØªØ´ÙÙŠØ§Øª</option>
              <option value="Ù†Ù‚Ø§Ø· ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø§Ù…Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø·Ø¨ÙŠØ©">Ù†Ù‚Ø§Ø· ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø§Ù…Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø·Ø¨ÙŠØ©</option>
              <option value="ÙÙ‚Ø¯Ø§Ù† Ø´Ø®Øµ">ÙÙ‚Ø¯Ø§Ù† Ø´Ø®Øµ</option>
              <option value="ÙÙ‚Ø¯Ø§Ù† Ù…Ù…ØªÙ„ÙƒØ§Øª">ÙÙ‚Ø¯Ø§Ù† Ù…Ù…ØªÙ„ÙƒØ§Øª</option>
              <option value="Ø£Ù„ØºØ§Ù… - Ù…ØªÙØ¬Ø±Ø§Øª">Ø£Ù„ØºØ§Ù… - Ù…ØªÙØ¬Ø±Ø§Øª</option>
              <option value="Ù…Ø¹Ù„ÙˆÙ…Ø© Ø¹Ù† Ø§Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„ØºØ°Ø§Ø¦ÙŠØ© Ø£Ùˆ ÙˆØ¬ÙˆØ¯ Ø§Ù„ØªÙƒØ§ÙŠØ§">Ù…Ø¹Ù„ÙˆÙ…Ø© Ø¹Ù† Ø§Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„ØºØ°Ø§Ø¦ÙŠØ© Ø£Ùˆ ÙˆØ¬ÙˆØ¯ Ø§Ù„ØªÙƒØ§ÙŠØ§</option>
              <option value="Ù…Ø¹Ù„ÙˆÙ…Ø© Ø¹Ù† Ø§Ù†ØªØµØ§Ø± Ø£Ùˆ Ø¯Ø®ÙˆÙ„ Ø£Ø­Ø¯ Ø·Ø±ÙÙŠ Ø§Ù„Ù†Ø²Ø§Ø¹ Ù„Ù…Ù†Ø·Ù‚Ø© Ù…Ø§">Ù…Ø¹Ù„ÙˆÙ…Ø© Ø¹Ù† Ø§Ù†ØªØµØ§Ø± Ø£Ùˆ Ø¯Ø®ÙˆÙ„ Ø£Ø­Ø¯ Ø·Ø±ÙÙŠ Ø§Ù„Ù†Ø²Ø§Ø¹ Ù„Ù…Ù†Ø·Ù‚Ø© Ù…Ø§</option>
              <option value="Ù‚Ø±Ø¨ Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ø­Ø±Ø¨">Ù‚Ø±Ø¨ Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ø­Ø±Ø¨</option>
              <option value="Ù…Ø¹Ù„ÙˆÙ…Ø© Ù…Ø¶Ù„Ù„Ø© Ø£Ø®Ø±Ù‰">Ù…Ø¹Ù„ÙˆÙ…Ø© Ù…Ø¶Ù„Ù„Ø© Ø£Ø®Ø±Ù‰</option>
            </select>
          </div>

          <!-- Follow-up -->
          <div class="mb-3 d-none" id="followup-wrapper">
            <label class="form-label fw-semibold" id="followup-label"></label>
            <select id="followup" name="followup" class="form-select"></select>
          </div>

          <!-- Decision -->
          <div class="mb-3">
            <label class="form-label fw-semibold">{% if lang == 'en' %}Did this misinformation lead you to make a decision?{% else %}Ù‡Ù„ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø© Ø§Ù„Ù…Ø¶Ù„Ù„Ø© Ù‚Ø§Ø¯ØªÙƒ Ù„Ø§ØªØ®Ø§Ø° Ù‚Ø±Ø§Ø± Ù…Ø¹ÙŠÙ†ØŸ{% endif %}</label>
            <select name="decision" class="form-select" required>
              <option value="">{% if lang == 'en' %}Select{% else %}Ø§Ø®ØªØ±{% endif %}</option>
              <option value="True">{% if lang == 'en' %}Yes{% else %}Ù†Ø¹Ù…{% endif %}</option>
              <option value="False">{% if lang == 'en' %}No{% else %}Ù„Ø§{% endif %}</option>
            </select>
          </div>

          <!-- Risk Level -->
          <div class="mb-3">
            <label class="form-label fw-semibold">{% if lang == 'en' %}Danger Level of this Decision{% else %}Ù…Ø³ØªÙˆÙ‰ Ø®Ø·ÙˆØ±Ø© Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø±Ø§Ø±{% endif %}</label>
            <div class="d-flex gap-3">
              <div class="form-check">
                <input class="form-check-input" type="radio" name="danger" value="High" id="high">
                <label class="form-check-label text-danger" for="high"><i class="bi bi-exclamation-triangle-fill text-danger"></i>{% if lang == 'en' %}High{% else %}Ø¹Ø§Ù„ÙŠØ©{% endif %}</label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="danger" value="Medium" id="medium">
                <label class="form-check-label text-warning" for="medium"><i class="bi bi-exclamation-triangle-fill text-warning"></i>{% if lang == 'en' %}Medium{% else %}Ù…ØªÙˆØ³Ø·Ø©{% endif %}</label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="danger" value="Low" id="low">
                <label class="form-check-label text-success" for="low"><i class="bi bi-check-circle-fill text-success"></i>{% if lang == 'en' %}Low{% else %}Ù…Ù†Ø®ÙØ¶Ø©{% endif %}</label>
              </div>
            </div>
          </div>

          <!-- Story -->
          <div class="mb-3">
            <label class="form-label fw-semibold">{% if lang == 'en' %}Your Story{% else %}Ù‚ØµØªÙƒ{% endif %}</label>
            <textarea id="story" name="story" class="form-control" rows="6" maxlength="3000" required></textarea>
            <div class="d-flex justify-content-between mt-1">
              <small class="text-muted">{% if lang == 'en' %}Max 3000 chars{% else %}Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ 3000 Ø­Ø±Ù{% endif %}</small>
              <small class="text-muted" id="char-count">0 / 3000</small>
            </div>
          </div>

          <!-- Media -->
          <div class="mb-3">
            <label for="media" class="form-label fw-semibold">{% if lang == 'en' %}Attach Media (optional){% else %}Ø¥Ø±ÙØ§Ù‚ ÙˆØ³Ø§Ø¦Ø· (Ø§Ø®ØªÙŠØ§Ø±ÙŠ){% endif %}</label>
            <input class="form-control" type="file" id="media" name="media" multiple accept="image/*,audio/*,video/*">
            <div class="form-text">{% if lang == 'en' %}Max 10 files{% else %}Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ 10 Ù…Ù„ÙØ§Øª{% endif %}</div>
            <ul id="file-list" class="mt-2 small text-muted"></ul>
          </div>

          <!-- Actions -->
          <div class="d-flex gap-3 mt-4">
            <button type="submit" class="btn btn-primary px-4 py-2 rounded-3 shadow-sm">{% if lang == 'en' %}ğŸš€ Share{% else %}ğŸš€ Ø¥Ø±Ø³Ø§Ù„{% endif %}</button>
            <a class="btn btn-outline-secondary px-4 py-2 rounded-3" href="{{ url_for('main.home_fully', lang=lang) }}">{% if lang == 'en' %}Cancel{% else %}Ø¥Ù„ØºØ§Ø¡{% endif %}</a>
          </div>

        </form>
      </div>
    </div>

  </div>
</section>

<!-- JS -->
<script>
  const regionSelect = document.getElementById('region');
const localityWrapper = document.getElementById('locality-wrapper');
const localitySelect = document.getElementById('locality');

const localities = {
  "Khartoum": [
    "Ù…Ø­Ù„ÙŠØ© Ø§Ù„Ø®Ø±Ø·ÙˆÙ…", "Ù…Ø­Ù„ÙŠØ© Ø£Ù… Ø¯Ø±Ù…Ø§Ù† Ø§Ù„ÙƒØ¨Ø±Ù‰", "Ù…Ø­Ù„ÙŠØ© Ø§Ù„Ø®Ø±Ø·ÙˆÙ… Ø¨Ø­Ø±ÙŠ",
    "Ù…Ø­Ù„ÙŠØ© Ø´Ø±Ù‚ Ø§Ù„Ù†ÙŠÙ„", "Ù…Ø­Ù„ÙŠØ© Ø£Ù… Ø¨Ø¯Ø©", "Ù…Ø­Ù„ÙŠØ© ÙƒØ±Ø±ÙŠ", "Ù…Ø­Ù„ÙŠØ© Ø¬Ø¨Ù„ Ø£ÙˆÙ„ÙŠØ§Ø¡"
  ],
  "Gezira": [
    "Ù…Ø­Ù„ÙŠØ© ÙˆØ¯ Ù…Ø¯Ù†ÙŠ Ø§Ù„ÙƒØ¨Ø±Ù‰", "Ù…Ø­Ù„ÙŠØ© Ø¬Ù†ÙˆØ¨ Ø§Ù„Ø¬Ø²ÙŠØ±Ø©", "Ù…Ø­Ù„ÙŠØ© Ø´Ø±Ù‚ Ø§Ù„Ø¬Ø²ÙŠØ±Ø©",
    "Ù…Ø­Ù„ÙŠØ© Ø§Ù„Ù…Ù†Ø§Ù‚Ù„", "Ù…Ø­Ù„ÙŠØ© Ø§Ù„Ø­ØµØ§Ø­ÙŠØµØ§", "Ù…Ø­Ù„ÙŠØ© Ø£Ù… Ø§Ù„Ù‚Ø±Ù‰",
    "Ù…Ø­Ù„ÙŠØ© Ø§Ù„ÙƒØ§Ù…Ù„ÙŠÙ†", "Ù…Ø­Ù„ÙŠØ© 24 Ø§Ù„Ù‚Ø±Ø´ÙŠ"
  ]
};

regionSelect.addEventListener('change', () => {
  const selected = regionSelect.value;
  localitySelect.innerHTML = '';
  if (localities[selected]) {
    localityWrapper.classList.remove('d-none');
    localities[selected].forEach(loc => {
      const opt = document.createElement('option');
      opt.textContent = loc;
      opt.value = loc;
      localitySelect.appendChild(opt);
    });
  } else {
    localityWrapper.classList.add('d-none');
  }
});

const misinfo = document.getElementById("misinfo");
const followupWrapper = document.getElementById("followup-wrapper");
const followupSelect = document.getElementById("followup");
const followupLabel = document.getElementById("followup-label");

misinfo.addEventListener("change", function() {
  followupSelect.innerHTML = "";
  let options = [];

  if (this.value === "Ø·Ø±Ù‚ ØºÙŠØ± Ø§Ù…Ù†Ø©") {
    followupLabel.textContent = "Ù…Ø§ Ù‡ÙŠ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù‚ØµØ©ØŸ";
    options = ["Ø§Ø±ØªÙƒØ§Ø²Ø§Øª Ø·Ø±ÙŠÙ‚", "Ø­ÙˆØ§Ø¬Ø²", "ØªÙØªÙŠØ´", "Ø£Ø®Ø±Ù‰"];
  } else if (this.value === "Ù…Ø³ØªØ´ÙÙŠØ§Øª") {
    followupLabel.textContent = "Ù…Ø§ Ù‡Ùˆ Ø§Ù„ÙˆØ¶Ø¹ØŸ";
    options = ["Ù…Ø³ØªØ´ÙÙ‰ Ù…ØºÙ„Ù‚", "Ø±ÙØ¶ Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ Ø­Ø§Ù„Ø§Øª", "Ù†Ù‚Øµ Ø£Ø·Ø¨Ø§Ø¡", "Ù…Ø³ØªØ´ÙÙŠØ§Øª ØªØ­Øª Ø³ÙŠØ·Ø±Ø© Ø§Ù„Ø¯Ø¹Ù…", "Ø£Ø®Ø±Ù‰"];
  } else if (this.value === "Ù†Ù‚Ø§Ø· ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø§Ù…Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø·Ø¨ÙŠØ©") {
    followupLabel.textContent = "Ù…Ø§ Ø§Ù„ØªÙØ§ØµÙŠÙ„ØŸ";
    options = ["Ø£Ø¯ÙˆÙŠØ© Ø£Ù…Ø±Ø§Ø¶ Ù…Ø²Ù…Ù†Ø©", "Ø£Ø¯ÙˆÙŠØ© Ù…ØºØ´ÙˆØ´Ø©", "Ø§Ø±ØªÙƒØ§Ø² ØªØ³Ø¨Ø¨ ÙÙŠ Ø§ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ù‚Ø§Ø·"];
  } else if (this.value === "ÙÙ‚Ø¯Ø§Ù† Ø´Ø®Øµ") {
    followupLabel.textContent = "Ù…Ø§ Ø§Ù„ØªÙØ§ØµÙŠÙ„ØŸ";
    options = ["Ø§Ø¹ØªÙ‚Ø§Ù„ / ØªØ¬Ù†ÙŠØ¯", "Ù…Ø¹Ù„ÙˆÙ…Ø© ÙƒØ§Ø°Ø¨Ø©", "ØªØ¶Ø®ÙŠÙ… Ø®Ø¨Ø±", "Ø£Ø®Ø±Ù‰"];
  } else if (this.value === "ÙÙ‚Ø¯Ø§Ù† Ù…Ù…ØªÙ„ÙƒØ§Øª") {
    followupLabel.textContent = "Ù…Ø§ Ø§Ù„ØªÙØ§ØµÙŠÙ„ØŸ";
    options = ["Ø¹Ù‚Ø§Ø± - Ù…Ù†Ø§Ø²Ù„ - Ù…Ø²Ø§Ø±Ø¹ - Ù…Ø­Ù„Ø§Øª ØªØ¬Ø§Ø±ÙŠØ©", "Ø³ÙŠØ§Ø±Ø§Øª - Ù…Ø§ÙƒÙŠÙ†Ø§Øª", "Ø°Ù‡Ø¨ - Ù†Ù‚ÙˆØ¯"];
  }

  if (options.length > 0) {
    followupWrapper.classList.remove("d-none");
    options.forEach(opt => {
      const o = document.createElement("option");
      o.textContent = opt;
      followupSelect.appendChild(o);
    });
  } else {
    followupWrapper.classList.add("d-none");
  }
});
</script>

{% endblock %}
